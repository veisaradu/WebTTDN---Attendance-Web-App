generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}
model Event {
  id              Int          @id @default(autoincrement())
  groupId         Int?
  name            String
  status          String       @default("CLOSED")
  startTime       DateTime
  endTime         DateTime
  maxParticipants Int?
  description     String?
  eventType       String?
  qrCode          String?
  textCode        String?

  attendance      Attendance[] @relation("EventAttendance")
}

model Participant {
  id          Int          @id @default(autoincrement())
  name        String
  email       String

  attendance  Attendance[] @relation("ParticipantAttendance")
}

model Attendance {
  id            Int         @id @default(autoincrement())
  participantId Int
  eventId       Int
  confirmedAt   DateTime
  ipAddress     String?
  status        String

  participant   Participant @relation(fields: [participantId], references: [id], map: "fk_attendance_participant", name: "ParticipantAttendance")
  event         Event       @relation(fields: [eventId], references: [id], map: "fk_attendance_event", name: "EventAttendance")

  @@unique([participantId, eventId], map: "unique_participant_event")
}
